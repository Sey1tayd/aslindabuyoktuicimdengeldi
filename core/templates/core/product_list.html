{% extends 'core/base.html' %}
{% load static %}

{% block content %}
<div class="container">
  <h1>Tüm Ürünler</h1>

  <form method="get" class="filters">
    <input type="text" name="search" value="{{ search_query|default:'' }}" placeholder="Ara..." />
    <select name="category">
      <option value="">Kategori (tümü)</option>
      {% for c in categories %}
        <option value="{{ c.slug }}" {% if current_category == c.slug %}selected{% endif %}>{{ c.name }}</option>
      {% endfor %}
    </select>
    <button type="submit">Filtrele</button>
  </form>

  <div class="product-grid">
    {% if products %}
      {% for p in products %}
        <div class="product-card">
          <a href="{% url 'core:product_detail' product_name=p.name|urlencode %}">
            <img src="{% static p.path %}" alt="{{ p.name }}" />
            <div class="name">{{ p.name }}</div>
          </a>
        </div>
      {% endfor %}
    {% else %}
      <p>Ürün bulunamadı.</p>
    {% endif %}
  </div>

  <div class="pagination">
    {% if products.has_previous %}
      <a href="?{% if search_query %}search={{ search_query }}&{% endif %}{% if current_category %}category={{ current_category }}&{% endif %}page={{ products.previous_page_number }}">Önceki</a>
    {% endif %}
    {% if products.paginator.num_pages > 1 %}
      <span>Sayfa {{ products.number }} / {{ products.paginator.num_pages }}</span>
    {% endif %}
    {% if products.has_next %}
      <a href="?{% if search_query %}search={{ search_query }}&{% endif %}{% if current_category %}category={{ current_category }}&{% endif %}page={{ products.next_page_number }}">Sonraki</a>
    {% endif %}
  </div>
</div>
{% endblock %}


